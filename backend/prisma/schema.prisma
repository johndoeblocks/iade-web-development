// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// ──────────────────────────────────────
// Enums
// ──────────────────────────────────────

enum OrderStatus {
  PENDENTE       @map("pendente")
  EM_PREPARACAO  @map("em preparação")
  ENTREGUE       @map("entregue")
}

// ──────────────────────────────────────
// Models
// ──────────────────────────────────────

model Pizza {
  id         Int      @id @default(autoincrement())
  nome       String
  descricao  String
  preco      Float
  imagem     String
  categoria  String
  disponivel Boolean  @default(true)

  // Relação com os items de encomenda
  orderItems OrderItem[]


  @@map("pizzas")
}

model Order {
  id          Int          @id @default(autoincrement())
  nome        String
  telefone    String
  morada      String
  observacoes String       @default("")
  total       Float
  status      OrderStatus  @default(PENDENTE)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime?    @updatedAt

  // Relação com os items da encomenda
  items       OrderItem[]

  @@map("orders")
}

model OrderItem {
  id         Int   @id @default(autoincrement())
  quantidade Int
  preco      Float

  // Relações
  order      Order @relation(fields: [orderId], references: [id], onDelete: Cascade)
  orderId    Int

  pizza      Pizza @relation(fields: [pizzaId], references: [id])
  pizzaId    Int

  @@map("order_items")
}

model Store {
  id        Int    @id @default(autoincrement())
  nome      String
  morada    String
  telefone  String
  horario   String
  lat       Float
  lng       Float

  @@map("stores")
}
